<div class="settings__content">
    <h1><i class="fa fa-{{icon}} settings__head-icon"></i> {{res 'setBrowserTitle'}}</h1>
    {{#if desktop}}
        <p>{{res 'setBrowserIntroDesktop'}}</p>
        <p>KeeWeb Connect: {{res 'setBrowserIntroKeeWebConnect'}}</p>
        <p>KeePassXC-Browser: {{res 'setBrowserIntroKeePassXcBrowser'}}</p>
        {{#if anyBrowserIsEnabled}}
            <p>{{res 'setBrowserEnablePerBrowser'}}</p>
        {{else}}
            <p class="error-color">{{res 'setBrowserNotEnabled'}}</p>
        {{/if}}
        <table class="settings__browser-table">
            <thead>
                <tr>
                    <th></th>
                    {{#each extensionNames as |ext|}}
                        <th>{{ext}}</th>
                    {{/each}}
                </tr>
            </thead>
            <tbody>
                {{#each settingsPerBrowser as |perBrowser|}}
                    <tr>
                        <td>{{perBrowser.browserName}}</td>
                        {{#each perBrowser.extensions as |setting|}}
                            <td>
                                {{#if setting.supported}}
                                    <input type="checkbox"
                                           class="check-enable-for-browser"
                                           {{#if setting.enabled}}checked{{/if}}
                                           id="check-enable-{{setting.alias}}-for-{{perBrowser.browser}}"
                                           data-browser="{{perBrowser.browser}}"
                                           data-extension="{{setting.alias}}" />
                                    <label for="check-enable-{{setting.alias}}-for-{{perBrowser.browser}}"></label>
                                {{else}}
                                    <i class="fa fa-times muted-color" title="{{res 'setBrowserExtensionNotSupported'}}"></i>
                                {{/if}}
                                {{#if setting.enabled}}
                                    {{#if setting.helpUrl}}
                                        <a href="{{setting.helpUrl}}" target="_blank" rel="noreferrer"
                                           class="settings__browser-extension-link icon-link"
                                           title="{{res 'setBrowserExtensionHelp'}}"
                                        >
                                            <i class="fa fa-info-circle"></i>
                                        </a>
                                    {{/if}}
                                    {{#if setting.installUrl}}
                                        <a href="{{setting.installUrl}}" target="_blank" rel="noreferrer"
                                           class="settings__browser-extension-link icon-link"
                                           title="{{res 'setBrowserExtensionInstall'}}"
                                        >
                                            <i class="fa fa-download"></i>
                                        </a>
                                    {{/if}}
                                {{/if}}
                            </td>
                        {{/each}}
                    </tr>
                {{/each}}
            </tbody>
        </table>
    {{else}}
        <p>{{res 'setBrowserIntroWeb'}}</p>
        <a href="{{extensionDownloadLink}}" target="_blank" rel="noreferrer">
            KeeWeb Connect {{#res 'setBrowserExtensionFor'}}{{extensionBrowserFamily}}{{/res}}
        </a>
    {{/if}}
    <p></p>

    <div>
        <input type="checkbox" class="settings__input input-base settings__browser-focus-if-locked"
               id="settings__browser-focus-if-locked"
               {{#if focusIfLocked}}checked{{/if}} />
        <label for="settings__browser-focus-if-locked">{{res 'setBrowserFocusIfLocked'}}</label>
    </div>

    <h2>{{res 'setBrowserSessions'}}</h2>
    {{#if sessions.length}}
        <p>{{res 'setBrowserSessionsIntro'}}</p>

        {{#each sessions as |session|}}
            <h3>
                <div class="settings__browser-extension-status
                     {{#if session.permissions}}
                         green-color
                     {{else if session.permissionsDenied}}
                         red-color
                     {{else}}
                         muted-color
                     {{/if}}"
                     title="
                     {{~#if session.permissions~}}
                         {{res 'setBrowserSessionsActiveTooltip'}}
                     {{~else if session.permissionsDenied~}}
                         {{res 'setBrowserSessionsDeniedTooltip'}}
                     {{~else~}}
                         {{res 'setBrowserSessionsInactiveTooltip'}}
                     {{/if}}"
                ></div>
                {{session.extensionName}} ({{session.appName}})
            </h3>
            <p>{{res 'setBrowserConnectedDate'}}: {{session.connectedDate}}</p>
            {{#if session.permissions}}
                {{res 'setBrowserSessionsActiveText'}}
            {{else if session.permissionsDenied}}
                {{res 'setBrowserSessionsDeniedText'}}
            {{else}}
                {{res 'setBrowserSessionsInactiveText'}}
            {{/if}}
            <div class="settings__browser-session-buttons">
                <button class="btn btn-error settings__browser-btn-terminate-session"
                        data-connection-id="{{session.connectionId}}"
                >{{res 'setBrowserTerminateSession'}}</button>
            </div>
        {{/each}}
    {{else}}
        <p>{{res 'setBrowserSessionsEmpty'}}</p>
    {{/if}}
</div>
